
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "tutorials/api/phasorpy_cursor.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: xml

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_tutorials_api_phasorpy_cursor.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_tutorials_api_phasorpy_cursor.py:


Cursors
=======

An introduction to selecting phasor coordinates using cursors.

.. GENERATED FROM PYTHON SOURCE LINES 10-11

Import required modules, functions, and classes:

.. GENERATED FROM PYTHON SOURCE LINES 11-25

.. code-block:: Python


    from phasorpy.color import CATEGORICAL
    from phasorpy.cursor import (
        mask_from_circular_cursor,
        mask_from_elliptic_cursor,
        mask_from_polar_cursor,
        pseudo_color,
    )
    from phasorpy.datasets import fetch
    from phasorpy.filter import phasor_threshold
    from phasorpy.io import signal_from_lsm
    from phasorpy.phasor import phasor_from_signal
    from phasorpy.plot import PhasorPlot, plot_image








.. GENERATED FROM PYTHON SOURCE LINES 26-27

Load a hyperspectral dataset used throughout this tutorial:

.. GENERATED FROM PYTHON SOURCE LINES 27-34

.. code-block:: Python


    signal = signal_from_lsm(fetch('paramecium.lsm'))
    mean, real, imag = phasor_from_signal(signal, axis=0)

    # remove coordinates with zero intensity
    mean_thresholded, real, imag = phasor_threshold(mean, real, imag, mean_min=1)








.. GENERATED FROM PYTHON SOURCE LINES 35-41

Circular cursors
----------------

Use circular cursors to mask regions of interest in the phasor space.
Define two cursors by specifying their real and imaginary coordinates
and radii:

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: Python


    cursor_real = [-0.33, 0.54]
    cursor_imag = [-0.72, -0.74]
    radius = [0.2, 0.22]

    circular_mask = mask_from_circular_cursor(
        real, imag, cursor_real, cursor_imag, radius=radius
    )








.. GENERATED FROM PYTHON SOURCE LINES 51-52

Show the circular cursors in a phasor plot:

.. GENERATED FROM PYTHON SOURCE LINES 52-64

.. code-block:: Python


    plot = PhasorPlot(allquadrants=True, title='Circular cursors')
    plot.hist2d(real, imag, cmap='Greys')
    plot.cursor(
        cursor_real,
        cursor_imag,
        radius=radius,
        color=CATEGORICAL[:2],
        label=['cursor 0', 'cursor 1'],
    )
    plot.show()




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_001.png
   :alt: Circular cursors
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 65-67

The cursor masks can be blended to produce a pseudo-colored image.
Each cursor's region is assigned a different color:

.. GENERATED FROM PYTHON SOURCE LINES 68-75

.. code-block:: Python


    pseudo_color_image = pseudo_color(*circular_mask)

    plot_image(
        pseudo_color_image, title='Pseudo-color image from circular cursors'
    )




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_002.png
   :alt: Pseudo-color image from circular cursors
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 76-78

The pseudo-color image is numpy array with values between 0 and 1 (RGB)
that can be further processed or saved as needed.

.. GENERATED FROM PYTHON SOURCE LINES 80-86

Elliptical cursors
------------------

Use elliptical cursors to mask better-defined regions of interest in the
phasor space. Elliptical cursors allow independent control of the radii,
which can better match elongated clusters in phasor space:

.. GENERATED FROM PYTHON SOURCE LINES 86-99

.. code-block:: Python


    radius = [0.1, 0.06]  # major axis
    radius_minor = [0.3, 0.25]  # minor axis

    elliptic_mask = mask_from_elliptic_cursor(
        real,
        imag,
        cursor_real,
        cursor_imag,
        radius=radius,
        radius_minor=radius_minor,
    )








.. GENERATED FROM PYTHON SOURCE LINES 100-101

Show the elliptical cursors in a phasor plot:

.. GENERATED FROM PYTHON SOURCE LINES 101-114

.. code-block:: Python


    plot = PhasorPlot(allquadrants=True, title='Elliptical cursors')
    plot.hist2d(real, imag, cmap='Greys')
    plot.cursor(
        cursor_real,
        cursor_imag,
        radius=radius,
        radius_minor=radius_minor,
        color=CATEGORICAL[:2],
        label=['cursor 0', 'cursor 1'],
    )
    plot.show()




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_003.png
   :alt: Elliptical cursors
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 115-117

The mean intensity image can be used as a base layer to overlay
the masks from the elliptical cursors:

.. GENERATED FROM PYTHON SOURCE LINES 118-126

.. code-block:: Python


    pseudo_color_image = pseudo_color(*elliptic_mask, intensity=mean)

    plot_image(
        pseudo_color_image,
        title='Pseudo-color image from elliptical cursors and intensity',
    )




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_004.png
   :alt: Pseudo-color image from elliptical cursors and intensity
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 127-132

Polar cursors
-------------

Use polar cursors to select regions of interest in the phasor space based
on phase and modulation ranges:

.. GENERATED FROM PYTHON SOURCE LINES 132-142

.. code-block:: Python


    phase_min = [-2.27, -1.22]
    phase_max = [-1.57, -0.70]
    modulation_min = [0.7, 0.8]
    modulation_max = [0.9, 1.0]

    polar_mask = mask_from_polar_cursor(
        real, imag, phase_min, phase_max, modulation_min, modulation_max
    )








.. GENERATED FROM PYTHON SOURCE LINES 143-144

Show the polar cursors in a phasor plot:

.. GENERATED FROM PYTHON SOURCE LINES 144-157

.. code-block:: Python


    plot = PhasorPlot(allquadrants=True, title='Polar cursors')
    plot.hist2d(real, imag, cmap='Greys')
    plot.polar_cursor(
        phase=phase_min,
        phase_limit=phase_max,
        modulation=modulation_min,
        modulation_limit=modulation_max,
        color=CATEGORICAL[2:4],  # use different colors
        label=['cursor 0', 'cursor 1'],
    )
    plot.show()




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_005.png
   :alt: Polar cursors
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 158-161

The thresholded mean intensity image can be used as a base layer to
overlay the masks from the polar cursors. Values below the threshold are
transparent (white):

.. GENERATED FROM PYTHON SOURCE LINES 161-171

.. code-block:: Python


    pseudo_color_image = pseudo_color(
        *polar_mask, intensity=mean_thresholded, colors=CATEGORICAL[2:]
    )

    plot_image(
        pseudo_color_image,
        title='Pseudo-color image from\npolar cursors and thresholded intensity',
    )




.. image-sg:: /tutorials/api/images/sphx_glr_phasorpy_cursor_006.png
   :alt: Pseudo-color image from polar cursors and thresholded intensity
   :srcset: /tutorials/api/images/sphx_glr_phasorpy_cursor_006.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.863 seconds)


.. _sphx_glr_download_tutorials_api_phasorpy_cursor.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: phasorpy_cursor.ipynb <phasorpy_cursor.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: phasorpy_cursor.py <phasorpy_cursor.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: phasorpy_cursor.zip <phasorpy_cursor.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
